app.customSelect={selectedItem:{},selectedCategory:{},selectedSection:{},stack:[],render:function(){$(".custom-select-render").remove();var e=Math.random(),t=$(".custom-select").attr("type","hidden").attr("data-id",e),s=t.attr("id");t.removeAttr("id").attr("data-element-id",s);var i=$('<div class="custom-select-render" id="'+s+'" data-id="'+e+'"></div>'),c=$('<div class="selected-element"></div>'),d=$('<div class="icons arrow-down"></div>'),a=$('<div class="select-list"></div>'),l=$('<div class="select-list-wrapper"></div>');$.each(this.stack,(function(e,t){if(t.items.length){var s=$('<div class="optgroup"></div>');s.append('<div class="optgroup-name">'+t.data.title+"</div>"),$.each(t.items,(function(e,t){var i=$('<div class="option" data-value="'+t.id+'"></div>'),c=$('<div class="name">'+t.title+"</div>"),d=$('<div class="price">'+t.price+" ₽</div>");if(t.oldprice>0){var a=$('<div class="oldprice">'+t.oldprice+" ₽</div>");d.prepend(a)}i.append(c).append(d),s.append(i)})),l.append(s)}})),a.append(l),i.append(c).append(d).append(a),t.after(i),this.select(i.find(".option").first())},select:function(e){var t=e.closest(".custom-select-render"),s=t.attr("data-id"),i=$('.custom-select[data-id="'+s+'"]'),c=t.find(".selected-element"),d=e.children(".name").text(),a=e.attr("data-value");this.selectedItem=app.items.selectedItem,c.html(d),i.val(a).trigger("change"),t.find(".option.selected").removeClass("selected"),e.addClass("selected"),t.removeClass("focus")}},app.items={sections:[],categories:[],items:[],selectedSection:{},selectedCategory:{},selectedItem:{},updateItems:function(){this.items=items,this.categories=categories,this.sections=sections,this.renderSectionsSlider(),app.customSelect.render()},renderSectionsSlider:function(){var e=this,t=$(".sections-slider > .slider-links > .slider-links-wrapper");$.each(this.sections,(function(s,i){var c=$('<li class="slider-link">'+i.title+"</li>").attr("title",i.text).attr("data-id","section-slide-"+i.id);0==s&&(c.addClass("active"),e.selectedSection=i),t.append(c)}))}},$((function(){$("body").on("click",".custom-select-render:not(.focus)",(function(e){e.preventDefault(),$(this).addClass("focus")})).on("click",".custom-select-render.focus > .selected-element",(function(e){e.preventDefault(),$(this).closest(".custom-select-render").removeClass("focus")})).on("click",".custom-select-render.focus .option",(function(e){e.preventDefault();var t=$(this);app.customSelect.select(t)})),$("html").on("click","body",(function(e){$(e.target).closest(".custom-select-render").length||$(".custom-select-render").removeClass("focus")}))}));